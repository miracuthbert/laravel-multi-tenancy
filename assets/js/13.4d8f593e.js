(window.webpackJsonp=window.webpackJsonp||[]).push([[13],{213:function(t,a,e){"use strict";e.r(a);var s=e(0),n=Object(s.a)({},(function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"tenant-setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#tenant-setup"}},[t._v("#")]),t._v(" Tenant Setup")]),t._v(" "),e("h2",{attrs:{id:"existing-model"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#existing-model"}},[t._v("#")]),t._v(" Existing Model")]),t._v(" "),e("p",[t._v("To setup an existing model as a tenant, add "),e("code",[t._v("IsTenant")]),t._v(" trait, plus "),e("code",[t._v("ForSystem")]),t._v(" if using a multi-database driver.")]),t._v(" "),e("h3",{attrs:{id:"creating"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#creating"}},[t._v("#")]),t._v(" Creating")]),t._v(" "),e("p",[t._v("Create a migration to update the intended table with the code below in the "),e("code",[t._v("up")]),t._v(" method:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$table")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("tenant")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("This will create a "),e("code",[t._v("uuid")]),t._v(" column and "),e("code",[t._v("domain")]),t._v(" column. The "),e("code",[t._v("uuid")]),t._v(" value is automatically handled by the package.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("To disable the "),e("code",[t._v("domain")]),t._v(" column from being added by pass an array of options to the macro with "),e("code",[t._v("domain")]),t._v(" set to "),e("code",[t._v("false")])])]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$table")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("tenant")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token single-quoted-string string"}},[t._v("'domain'")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean constant"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("h3",{attrs:{id:"dropping"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#dropping"}},[t._v("#")]),t._v(" Dropping")]),t._v(" "),e("p",[t._v("In the "),e("code",[t._v("down")]),t._v(" method of the migration:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$table")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("dropTenant")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])]),e("p",[t._v("Alternatively, you can run the command:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[t._v("php artisan tenancy"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("migration "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("--")]),t._v("table"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("table_name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Switch "),e("code",[t._v("{name}")]),t._v(" with the name of the migration file and "),e("code",[t._v("{table_name}")]),t._v(" with the name of the "),e("code",[t._v("table")]),t._v(" you want to update.")]),t._v(" "),e("div",{staticClass:"custom-block danger"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("Before running "),e("code",[t._v("php artisan migrate")]),t._v(", you must setup the "),e("code",[t._v("model")]),t._v(" key and "),e("code",[t._v("users")]),t._v(" key values in "),e("code",[t._v("config/tenancy.php")])])]),t._v(" "),e("h2",{attrs:{id:"new-model"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#new-model"}},[t._v("#")]),t._v(" New Model")]),t._v(" "),e("p",[t._v("You can use the command below to create a fresh tenant model:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("php artisan tenancy:model {name}\n")])])]),e("p",[t._v("The "),e("code",[t._v("{name}")]),t._v(" being the name of the model (with the corresponding namespace).")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("All the options available for the "),e("code",[t._v("make:model")]),t._v(" command can be used here")])]),t._v(" "),e("h3",{attrs:{id:"options"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#options"}},[t._v("#")]),t._v(" Options")]),t._v(" "),e("ul",[e("li",[e("code",[t._v("-m")]),t._v(": Creates a tenant specific migration file (overrides the default migration)")]),t._v(" "),e("li",[e("code",[t._v("--multi")]),t._v(": Indicates if the generated file should be for a multi-database tenant")]),t._v(" "),e("li",[e("code",[t._v("--columns-only")]),t._v(": Indicates if the created migration should only add tenant columns to an existing table (can only be used along with "),e("code",[t._v("--model")]),t._v(" option)")])]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("By default the model generated will have the functionality for the single driver unless "),e("code",[t._v("--multi")]),t._v(" option passed.")])]),t._v(" "),e("h2",{attrs:{id:"users"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#users"}},[t._v("#")]),t._v(" Users")]),t._v(" "),e("p",[t._v("To setup tenant users run:")]),t._v(" "),e("div",{staticClass:"language-php extra-class"},[e("pre",{pre:!0,attrs:{class:"language-php"}},[e("code",[t._v("php artisan tenancy"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("users "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("name"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("Replace "),e("code",[t._v("{name}")]),t._v(" with the name of the pivot table. Example for model "),e("code",[t._v("Team")]),t._v(" with users will be "),e("code",[t._v("team_user")]),t._v(".")]),t._v(" "),e("div",{staticClass:"custom-block warning"},[e("p",{staticClass:"custom-block-title"},[t._v("WARNING")]),t._v(" "),e("p",[t._v("The package uses Laravel's naming convention for pivot tables and resolving the relationships.")])]),t._v(" "),e("p",[t._v("See the "),e("RouterLink",{attrs:{to:"/guide/configuration/#users"}},[t._v("users")]),t._v(" section in configuration for more on users and the "),e("RouterLink",{attrs:{to:"/guide/drivers/"}},[t._v("drivers")]),t._v(" section for more on drivers.")],1),t._v(" "),e("h2",{attrs:{id:"seeding"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#seeding"}},[t._v("#")]),t._v(" Seeding")]),t._v(" "),e("p",[t._v("Currently seeding functionality is supported for the "),e("code",[t._v("multi")]),t._v(" database driver only.")]),t._v(" "),e("p",[t._v("Whenever a "),e("code",[t._v("tenant")]),t._v(" is created their database can be seeded.")]),t._v(" "),e("div",{staticClass:"custom-block tip"},[e("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),e("p",[t._v("To seed a tenant database, related seeders should be registered in the "),e("code",[t._v("TenantDatabaseSeeder")])])])])}),[],!1,null,null,null);a.default=n.exports}}]);